{% extends "global/Page.html" %} {% block content %}
<h3>Discussion avec votre partenaire</h3>
<div class="card">
  <div class="card-body">
    <div
      id="chat-box"
      style="
        border: 1px solid #ccc;
        height: 200px;
        overflow-y: auto;
        padding: 10px;
      "
    ></div>
    <div class="input-group mt-2">
      <input
        type="text"
        id="chat-input"
        class="form-control"
        placeholder="Tapez votre message ici"
      />
      <div class="input-group-append">
        <button id="send-btn" class="btn btn-primary">Envoyer</button>
      </div>
    </div>
  </div>
</div>

<script>
  const box = document.getElementById("chat-box");
  const input = document.getElementById("chat-input");
  const sendBtn = document.getElementById("send-btn");

  liveRecv((data) => {
    if (data.new_message) {
      box.innerHTML += data.new_message;
      box.scrollTop = box.scrollHeight;
    }
  });

  sendBtn.addEventListener("click", () => {
    const msg = input.value.trim();
    if (msg) {
      liveSend({ message: msg });
      input.value = "";
    }
  });
</script>

<div class="mt-4">{{ next_button }}</div>
{% endblock %}
